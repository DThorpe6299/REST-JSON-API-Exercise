<!DOCTYPE html>
<html>
<head>
    <title>Cupcake List</title>
</head>
<body>
    <h1>Cupcake List</h1>
    <ul id="cupcake-list">
        <!-- Empty list to be populated by JavaScript -->
    </ul>

    <form id="cupcake-form">
        <input type="text" id="flavor" placeholder="Flavor">
        <input type="text" id="size" placeholder="Size">
        <input type="number" id="rating" placeholder="Rating">
        <input type="text" id="image" placeholder="Image URL">
        <button type="submit">Add Cupcake</button>
    </form>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // JavaScript code to fetch cupcakes and handle form submission
        $(document).ready(function() {
            // Function to fetch cupcakes and populate the list
            function getCupcakes() {
                axios.get('/api/cupcakes')
                    .then(function(response) {
                        // Clear the cupcake list
                        $('#cupcake-list').empty();

                        // Iterate through cupcakes and append to the list
                        response.data.cupcakes.forEach(function(cupcake) {
                            $('#cupcake-list').append(`<li>${cupcake.flavor} - ${cupcake.size} - ${cupcake.rating}</li>`);
                        });
                    })
                    .catch(function(error) {
                        console.log(error);
                    });
            }

            // Initial fetch of cupcakes when the page loads
            getCupcakes();

            // Handling form submission
            $('#cupcake-form').submit(function(event) {
                event.preventDefault();

                // Get form values
                const flavor = $('#flavor').val();
                const size = $('#size').val();
                const rating = $('#rating').val();
                const image = $('#image').val();

                // Send POST request to add a new cupcake
                axios.post('/api/cupcakes', {
                    flavor: flavor,
                    size: size,
                    rating: rating,
                    image: image
                })
                .then(function(response) {
                    // After successful addition, fetch and update cupcake list
                    getCupcakes();
                })
                .catch(function(error) {
                    console.log(error);
                });
            });
        });
    </script>
</body>
</html>
